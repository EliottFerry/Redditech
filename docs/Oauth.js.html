<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Oauth.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Oauth.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { authorize } from "react-native-app-auth";
import serviceStorage from '../services/Storage';
import { CLIENT_ID, CLIENT_ID_B64 } from '@env';

/**&lt;pre>
 * This variable hold all the data that we need to connect to the reddit API without error.
 * redirectUrl = Where do we want to be redirected after being connected
 * clientId = The ID of the installed app in the reddit/prefs/app
 * clientSecret = Empty string for installed app
 * serviceConfiguration :
 *    - authorizationEndpoint = The page to authorize your account to connect with OAuth2
 *    - tokenEndpoint = The url in which we are posting data to get the access token
 * customHeaders :
 *    - token:
 *        - Authorization = Your client ID in base 64
 * additionalParameters :
 *    - duration = "permanent" if you want a refresh token
 */
const config = {
  redirectUrl: 'com.reacttest://oauth2redirect/reddit',
  clientId: "weyNMS6YCN78ce_KXRlgbA",
  clientSecret: '',
  scopes: ["identity","history","edit","mysubreddits","privatemessages","read","report","save","submit","vote","subscribe"],
  serviceConfiguration: {
    authorizationEndpoint: 'https://www.reddit.com/api/v1/authorize.compact',
    tokenEndpoint: 'https://www.reddit.com/api/v1/access_token',
  },
  customHeaders: {
    token: {
      Authorization: "d2V5Tk1TNllDTjc4Y2VfS1hSbGdiQQ",
    },
  },
  additionalParameters: {
    duration: "permanent",
  },
};

/*&lt;pre> 
 * This function is used to connect to the reddit API using OAuth2
 * It's also pushing in the Async Storage the accessToken, the refreshToken and the clientId
 * Then it's navigating onto the home page of the app when the connection is done.
*/
async function oauth({ navigation })
{
  try {
    console.log(CLIENT_ID);
    const authState = await authorize(config);
    serviceStorage.pushData("accessToken", authState.accessToken);
    serviceStorage.pushData("refreshToken", authState.refreshToken);
    serviceStorage.pushData("clientId", config.clientId);
    navigation.reset({
        index: 0,
        routes: [{ name: 'Redditech'}],
    });
  } catch (e) {
    console.log(e);
  };
}

export default oauth;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#config">config</a></li><li><a href="global.html#getData">getData</a></li><li><a href="global.html#getInfo">getInfo</a></li><li><a href="global.html#getObj">getObj</a></li><li><a href="global.html#pushData">pushData</a></li><li><a href="global.html#pushObj">pushObj</a></li><li><a href="global.html#Snoowrap">Snoowrap</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Oct 29 2021 12:02:53 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
